{% load static %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="{% static 'css/forms.css' %}" rel="stylesheet">
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/habibmhamadi/multi-select-tag@4.0.1/dist/css/multi-select-tag.min.css">

<div class="container">
  <div class="onboard-card">
    <h2>Step {{ wizard.steps.step1 }} of {{ wizard.steps.count }}: {{ step_title }}</h2>

    <form method="post" {% if form_enctype %} enctype="{{ form_enctype|default:'application/x-www-form-urlencoded' }}" {% endif %}>
      {% csrf_token %}
      {{ wizard.management_form }}

      {% if wizard.steps.current == 'subjects' %}
        <div class="mb-3">
          {{ wizard.form.favourite_subjects }}
          {% if wizard.form.favourite_subjects.errors %}
            {% for error in wizard.form.favourite_subjects.errors %}
              <div class="text-danger small mt-1">{{ error }}</div>
            {% endfor %}
          {% endif %}
        </div>
      {% else %}
      {% for field in wizard.form %}
        <div class="mb-3">
          <label class="form-label">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <small class="form-text text-muted">{{ field.help_text }}</small>
          {% endif %}
          {% for error in field.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div> 
      {% endfor %}
      {% endif %}
      <div class="d-flex justify-content-between">
        {% if wizard.steps.prev %}
          <button class="btn btn-back" name="wizard_goto_step" value="{{ wizard.steps.prev }}">Back</button>
        {% endif %}
        <button type="submit" class="btn btn-primary">
          {% if wizard.steps.current == wizard.steps.last %}
            Finish
          {% else %}
            Next
          {% endif %}
        </button>
      </div>
    </form>
  </div>
</div>


<script src="https://cdn.jsdelivr.net/gh/habibmhamadi/multi-select-tag@4.0.1/dist/js/multi-select-tag.min.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("input, select, textarea").forEach(el => {
      el.classList.add("form-control");
    });
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    new MultiSelectTag('id_fav_subjects', {
      placeholder: 'Choose one or more subjects',
      maxSelection: 4,
      onChange: function(values) {
        console.log("Selected:", values);
      }
    });
  });
</script>